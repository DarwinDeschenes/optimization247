CC=gcc
CFLAGS=-I. -g
CPP=g++
CPPFLAGS=-I. -g -std=c++11 
DEPS =
ODDOBJ = oddinacci.o
MATOBJ = matrix.o
MAT0OBJ = mat0.o
MAT1OBJ = mat1.o
MAT2OBJ = mat2.o
MEASUREOBJ = measure.o
TRANSPOSEOBJ = transpose.o
TESTTARGET=opt_test
ODDTARGET=odd
MAT0TARGET=mat0
MAT1TARGET=mat1
MAT2TARGET=mat2
TRANSPOSETARGET=transpose
TESTMAIN=test/test_main.o
ODDMAIN=oddinacci_main.o
MAT0MAIN=mat0_main.o
MAT1MAIN=mat1_main.o
MAT2MAIN=mat2_main.o
TRANSPOSE_MAIN=transpose_main.o

%.o: %.c $(DEPS)
	$(CC) -c -o $@ $< $(CFLAGS)

%.o: %.cpp $(DEPS)
	$(CPP) -c -o $@ $< $(CPPFLAGS)

default: $(TESTTARGET) $(ODDTARGET) $(MAT0TARGET) $(MAT1TARGET) $(MAT2TARGET) $(TRANSPOSETARGET)

$(ODDTARGET): $(ODDOBJ) $(ODDMAIN) $(MEASUREOBJ)
	$(CC) -o $@ $(ODDOBJ) $(ODDMAIN) $(MEASUREOBJ) $(CFLAGS)

$(MAT0TARGET): $(MAT0OBJ) $(MAT0MAIN) $(MEASUREOBJ) $(MATOBJ)
	$(CC) -o $(MAT0TARGET) $(MAT0OBJ) $(MAT0MAIN) $(MEASUREOBJ)  $(MATOBJ) $(CFLAGS)

$(MAT1TARGET): $(MAT1OBJ) $(MAT1MAIN) $(MEASUREOBJ) $(MATOBJ)
	$(CC) -o $(MAT1TARGET) $(MAT1OBJ) $(MAT1MAIN) $(MEASUREOBJ) $(MATOBJ) $(CFLAGS)

$(MAT2TARGET): $(MAT2OBJ) $(MAT2MAIN) $(MEASUREOBJ) $(MATOBJ)
	$(CC) -o $(MAT2TARGET) $(MAT2OBJ) $(MAT2MAIN) $(MEASUREOBJ) $(MATOBJ) $(CFLAGS)

$(TRANSPOSETARGET): $(TRANSPOSEOBJ) $(TRANSPOSE_MAIN) $(MEASUREOBJ)
	$(CC) -o $(TRANSPOSETARGET) $(TRANSPOSEOBJ) $(TRANSPOSE_MAIN) $(MEASUREOBJ) $(CFLAGS)

clean:
	rm -f *.o test/*.o $(TESTTARGET) $(ODDTARGET) $(MAT0TARGET) $(MAT1TARGET) $(MAT2TARGET) $(TRANSPOSETARGET)


$(TESTTARGET): $(ODDOBJ) $(MATOBJ) $(MAT0OBJ) $(MAT1OBJ) $(MAT2OBJ) $(MEASUREOBJ) $(TESTMAIN) $(TRANSPOSEOBJ)
	g++ $(TESTMAIN) $(ODDOBJ) $(MATOBJ) $(MAT0OBJ) $(MAT1OBJ) $(MAT2OBJ) $(MEASUREOBJ) $(TRANSPOSEOBJ) \
		-o $(TESTTARGET) $(CPPFLAGS)

test-odd: $(TESTTARGET)
	./$(TESTTARGET) Oddinacci

test-mat0: $(TESTTARGET)
	./$(TESTTARGET) Matrix0

test-mat1: $(TESTTARGET)
	./$(TESTTARGET) Matrix1

test-mat2: $(TESTTARGET)
	./$(TESTTARGET) Matrix2

test-transpose: $(TESTTARGET)
	./$(TESTTARGET) Transpose

test: $(TESTTARGET)
	./$(TESTTARGET)
